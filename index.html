<!DOCTYPE html>
<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at https://mozilla.org/MPL/2.0/. -->
<html>
<head>
   <title>Macroura Music Editor - Sketch Kit</title>
   <link rel="stylesheet" href="src/layout.css"/>
</head>
<body>
   <div class="container horizontal">
      <div id="wmsx" class="item" style="min-width: 700px;"><h3>MuSICA Editor</h3><div id="wmsx-screen"></div><p>Powered by <a href="http://webmsx.org/">WebMSX</a></p></div>
      <div class="item container vertical">
         <h3>Record from MIDI (Monophonic)</h3>
         <h4>MIDI Settings</h4>
			<div><label for="tempo">Tempo</label><input id="tempo" name="tempo" value="130"></input></div>
			<div><label for="polynum">Polyphony</label><select id="polynum" name="polynum"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4" selected>4</option></select></div>
         <div><button class="blue" onclick="startRecording(Number.parseInt(polynum.value),Number.parseInt(tempo.value))">Record MIDI</button><!--<button class="blue">Record Keyboard</button>--><button class="red" onclick="stopRecording()">Stop Recording</button></div>
         <h4>Block Data</h4>
         <textarea id="definitions" style="flex: 1;"></textarea>
      </div>
      <div class="item container vertical"><h3>Chord Extension Transpiler</h3>
         <h4>Input MML File with chords</h4>
	 <textarea id="inchord" style="flex: 1;">; Title: 
; Author: 
FM1 =
FM2 =
FMC =
FM3 =
FMT =
FM4 =
FM5 =
FM6 =
FMR =
FM7 =
FM8 =
FM9 =
PSG1=
PSG2=
PSG3=
SCC1=
SCC2=
SCC3=
SCC4=
SCC5=
</textarea>
         <div><button class="blue" onclick="outchord.value = processMMLFileForChords(inchord.value)">Expand Chords</button></div>
	 <h4>Output MuSICA compatible MML File</h4>
	 <textarea id="outchord" rows=7></textarea>
      </div>
      <div class="item container vertical">
         <h3>Percussion Sequencer</h3>
         <p>Beat List:</p>
         <textarea id="outbeats" style="flex: 1;"></textarea>
      </div>
   </div>
   <script src="src/midi-polyphonic.js"></script>
   <script src="src/chord-sequencer.js"></script>
   <script src="src/drumkit-sequencer.js"></script>
   <script src="lib/wmsx.js"></script>
   <script>
      WMSX.PRESETS = "scc2, disk"
      WMSX.MACHINE = "MSX2A" // Previously used "MSX1J" to match the Toshiba HX-21
      WMSX.DISKA_URL = "res/musica.dsk"
      WMSX.BOOT_KEYS = "y,d2,num_2" // Hacky for sure.  The d2 triggers the sending of y, but is itself not a 2, so we use num_2 to send the 2.
   </script>
   <script src="src/patch-wmsx.js"></script>
   <script>
      // How to send a string to the keyboard buffer
      //WMSX.room.machineControls.processControlState(wmsx.MachineControls.TYPE_STRING, true, false, 'Hello, world!');
   </script>
</body>
</html>
